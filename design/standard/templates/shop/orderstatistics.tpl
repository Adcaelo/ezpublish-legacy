{* DO NOT EDIT THIS FILE! Use an override template instead. *}
<form action={concat("/shop/statistics")|ezurl} method="post" name="Statistics">
<div class="maincontentheader">
  <h1>{"Statistics"|i18n("design/standard/shop")}</h1>
</div>

<select name="Year">
    <option value="0" {section show=eq($year,0)}selected="selected"{/section}>[{"All Year"|i18n("design/standard/shop")}]</option>
    {section var=YearValue loop=$year_list}
        <option value="{$YearValue}" {section show=eq($YearValue,$year)}selected="selected"{/section}>{$YearValue}</option>
    {/section}
</select>
&nbsp;

<select name="Month">
    <option value="0" {section show=eq($month,0)}selected="selected"{/section}>[{"All Month"|i18n("design/standard/shop")}]</option>
    {section var=MonthItem loop=$month_list}
        <option value="{$MonthItem.value}" {section show=eq($MonthItem.value,$month)}selected="selected"{/section}>{$MonthItem.name}</option>
    {/section}
</select>
&nbsp;

<input class="button" type="submit" name="View" value="{'View'|i18n('design/standard/shop')}" />

{if $statistic_result}
{def $currency = false()
     $locale = false()
     $symbol = false()
     $product_info_count = false()}

<table class="list" width="100%" cellspacing="0" cellpadding="0" border="0">
<tr>
	<th>
	{"Product"|i18n("design/standard/shop")}
	</th>
	<th>
	{"Amount"|i18n("design/standard/shop")}
	</th>
	<th>
	{"Total ex. VAT"|i18n("design/standard/shop")}
	</th>
	<th>
	{"Total inc. VAT"|i18n("design/standard/shop")}
	</th>
</tr>

{section var=Product loop=$statistic_result[0].product_list sequence=array(bglight,bgdark)}

{set product_info_count = $Product.product_info|count()}
{foreach $Product.product_info as $currency_code => $info}
{if $currency_code}
    {set currency = fetch( 'shop', 'currency', hash( 'code', $currency_code ) )}
{else}
    {set currency = false()}
{/if}

{if $currency}
    {set locale = $currency.locale
         symbol = $currency.symbol}
{else}
    {set locale = false()
         symbol = false()}
{/if}

<tr>
    {if $product_info_count}
    	<td class="{$Product.sequence}" rowspan="{$product_info_count}">
        {content_view_gui view=text_linked content_object=$Product.product}
    	</td>
        {set product_info_count = false()}
    {/if}
    <td class="{$Product.sequence}">
	{$info.sum_count}
	</td>
	<td class="{$Product.sequence}">
	{$info.sum_ex_vat|l10n( 'currency', $locale, $symbol )}
	</td>
	<td class="{$Product.sequence}">
	{$info.sum_inc_vat|l10n( 'currency', $locale, $symbol )}
	</td>
</tr>
{/foreach}
{/section}

{def $total_sum_info_count = $statistic_result[0].total_sum_info|count()}
{foreach $statistic_result[0].total_sum_info as $currency_code => $info}

{if $currency_code}
    {set currency = fetch( 'shop', 'currency', hash( 'code', $currency_code ) )}
{else}
    {set currency = false()}
{/if}

{if $currency}
    {set locale = $currency.locale
         symbol = $currency.symbol}
{else}
    {set locale = false()
         symbol = false()}
{/if}

<tr>
    {if $total_sum_info_count}
    	<td class="bgdark" rowspan="{$total_sum_info_count}">
        <h2>{"SUM:"|i18n("design/standard/shop")}</h2>
    	</td>
        {set total_sum_info_count = false()}
    {/if}
    <td class="bgdark">
	</td>
	<td class="bgdark">
    <b>{$info.sum_ex_vat|l10n( 'currency', $locale, $symbol )}</b>
	</td>
	<td class="bgdark">
	<b>{$info.sum_inc_vat|l10n( 'currency', $locale, $symbol )}</b>
	</td>
</tr>
{/foreach}
</table>
{undef $currency $locale $symbol $product_info_count $total_sum_info_count}
{/if}
</form>